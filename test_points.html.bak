<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Points System Test</title>
    <style>
        body {
            font-family: 'Malgun Gothic', sans-serif;
            background: linear-gradient(135deg, #ff6b35 0%, #f7931e 50%, #ff9500 100%);
            padding: 20px;
            color: white;
        }
        
        .container {
            max-width: 600px;
            margin: 0 auto;
            background: rgba(0, 0, 0, 0.3);
            padding: 20px;
            border-radius: 10px;
        }
        
        .points-display {
            font-size: 24px;
            margin: 20px 0;
            text-align: center;
        }
        
        .btn {
            background: #ff6b35;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            font-size: 16px;
        }
        
        .btn:hover {
            background: #f7931e;
        }
        
        .stats {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>🏆 포인트 시스템 테스트</h1>
        
        <div class="points-display">
            현재 포인트: <span id="currentPoints">0</span>
        </div>
        
        <div>
            <button class="btn" onclick="addTestPoints(100, 'drum_beat')">드럼 비트 포인트 추가 (+100)</button>
            <button class="btn" onclick="addTestPoints(250, 'galaxy_war')">갤럭시 워 포인트 추가 (+250)</button>
            <button class="btn" onclick="addTestPoints(500, 'test_game')">테스트 게임 포인트 추가 (+500)</button>
        </div>
        
        <div>
            <button class="btn" onclick="showStats()">통계 보기</button>
            <button class="btn" onclick="resetPoints()">포인트 초기화</button>
        </div>
        
        <div class="stats" id="stats" style="display: none;">
            <h3>📊 통계</h3>
            <div id="statsContent"></div>
        </div>
        
        <div class="stats">
            <h3>📝 로그</h3>
            <div id="log"></div>
        </div>
    </div>

    <script src="js/gamePoints.js"></script>
    <script>
        function updateDisplay() {
            document.getElementById('currentPoints').textContent = window.getTotalPoints().toLocaleString();
        }

        function addTestPoints(points, gameId) {
            const gameInfo = {
                score: points * 10,
                accuracy: Math.floor(Math.random() * 100),
                combo: Math.floor(Math.random() * 50),
                playTime: Math.floor(Math.random() * 300),
                isNewRecord: Math.random() > 0.8
            };

            const totalEarned = window.addGamePoints(points * 10, gameId, gameInfo);
            log(`${gameId}: ${totalEarned} 포인트 획득! (총 ${window.getTotalPoints()} 포인트)`);
            updateDisplay();
        }

        function showStats() {
            const stats = window.getGameStats();
            const statsDiv = document.getElementById('stats');
            const content = document.getElementById('statsContent');
            
            content.innerHTML = `
                <p><strong>총 게임 플레이:</strong> ${stats.totalGamesPlayed}회</p>
                <p><strong>총 플레이 시간:</strong> ${Math.round(stats.totalPlayTime / 60)}분</p>
                <p><strong>연속 플레이:</strong> ${stats.streak}일</p>
                <p><strong>현재 레벨:</strong> ${window.gamePoints.getCurrentLevel()}</p>
                <p><strong>다음 레벨까지:</strong> ${window.gamePoints.getPointsToNextLevel()} 포인트</p>
                <p><strong>도전과제:</strong> ${stats.achievements.length}개</p>
                <h4>게임별 통계:</h4>
                ${Object.keys(stats.gameStats).map(game => 
                    `<p>${game}: ${stats.gameStats[game].playCount}회 플레이, ${stats.gameStats[game].totalPoints} 포인트</p>`
                ).join('')}
            `;
            
            statsDiv.style.display = statsDiv.style.display === 'none' ? 'block' : 'none';
        }

        function resetPoints() {
            if (confirm('정말로 모든 포인트와 통계를 초기화하시겠습니까?')) {
                window.gamePoints.resetPoints();
                window.gamePoints.resetStats();
                updateDisplay();
                log('포인트 시스템 초기화됨');
            }
        }

        function log(message) {
            const logDiv = document.getElementById('log');
            const timestamp = new Date().toLocaleTimeString();
            logDiv.innerHTML = `<div>[${timestamp}] ${message}</div>` + logDiv.innerHTML;
        }

        // Listen for achievement notifications
        window.addEventListener('pointsEarned', (event) => {
            log(`포인트 획득 이벤트: ${event.detail.points} 포인트`);
        });

        // Initialize display
        updateDisplay();
        log('포인트 시스템 테스트 페이지 로드됨');
    </script>
</body>
</html>